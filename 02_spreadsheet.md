# 第2章 Excelによる表計算

**問題** 以下の範囲選択方法の違いを調べよ。ただし，使い道が同じものもある。

* マウスでドラッグ
* Shiftキーを押しながらカーソル移動
* 始点をクリックしたあとで，Shiftキーを押しながら終点をクリック
* Ctrlキーを押しながら，クリックあるいはドラッグ
* 行（あるいは列）ラベルをクリック

**問題** 次の表で，A1の値とB1の値を足した結果をC1に記入する方法を述べよ。ただし，A1やB1の値が変わったら，C1の値は自動的に変わるようにせよ。

|      |A  |B  |C  |
|------|---|---|---|
|**1** |1  |10 |   |
|**2** |2  |20 |   |
|**3** |3  |30 |   |

**問題** 上問の結果のC1をC2にコピーしたときの振る舞いを調べよ。（「参照元のトレース」を利用してみよ。）

**問題** 上の表で，A1, A2, A3の和をA4に記入せよ。ただし，`+`を使うこと。

**問題** A4の値をA5にコピーせよ。

**問題** 「値」だけを貼り付けるキーボードショートカットは何か。ヒント：Altキーから始まる。

**問題** 上の表で，B1, B2, B3の和をB4に記入せよ。ただし，関数`SUM`を使うこと。（範囲が引数になる場合の記法を確認せよ。）

**問題** A列の各セルの値を，A4の値で割った結果をD列に記入せよ。ヒント：`$`を使う。（**相対セル番地**と**絶対セル番地**）

**問題** D列の値を小数第3位で四捨五入した結果をE列に記入せよ。

**問題** C列の最大値をF1に，最小値をF2に記入せよ。ただし，A列やB列の値が変わったら，F1，F2の値は自動的に変わるようにせよ。

**問題** 自分が生まれてから何日が経過したかを計算せよ。ヒント：今日は`TODAY()`である。（日時の内部表現を**シリアル値**と呼ぶ。）

**問題** 起床してから何時間が経過したかを計算せよ。ヒント：起床時刻は`2018/4/1 7:00`のように入力すればよい。現在時刻は`NOW()`である。

**問題** xについての方程式ax^2+bx+c=0を解くようなシートを作れ。A1にa，B1にb，C1にcの値を入れると，D1とD2に解が表示されればよい。方程式の解き方は http://www.wolframalpha.com/input/?i=solve+a+x%5E2+%2B+b+x+%2B+c+%3D+0+for+x を参照。

**問題（オプショナル）** 上問で，aが0の場合や，解が複素数になる場合も解が得られるようにせよ。

**問題（オプショナル）** x, yについての連立方程式{ax+by=e, cx+dy=f}
を解くようなシートを作れ。A1にa，B1にb，C1にc，D1にd，E1にe，F1にfの値を入れると，G1にx，G2にyの値が表示されればよい。余裕があれば，解が存在しない場合や，解が無限に存在する場合にも対応してみよ。連立方程式の解き方は http://www.wolframalpha.com/input/?i=solve+a+x%2Bb+y%3De,c+x%2Bd+y%3Df+for+x,y を参照。（`MINVERSE`と`MMULT`を使ってもよい。）

**問題** 世界の主要地域別人口の1950～1990と1990～2000，2000～2025，2025～2050の各年代の（1年あたりの）人口増加率を求めよ。人口の減少が最も早く始まる地域はどこか。ヒント：ある年の人口がAで，t年後の人口がBだとすると，B=A(1+r)^tとなる。これをrについて解くと，r=(B/A)^(1/t)-1となる。こういう式変形が苦手な人は，Wolfram/Alphaを使えばよい（ http://www.wolframalpha.com/input/?i=solve+b%3Da+(1%2Br)%5Et+for+r ）。（世界の主要地域別人口のデータは， http://www.asakura.co.jp/G_27_2.php?id=36 で公開されている。）

**問題（オプショナル）** 増加率を計算する際の時間間隔を，1ヶ月あたり，1日あたり，…と細かくしていくこともできる。最終的にはdp/dt=rp（pは人口，rは定数）という微分方程式になる。このモデルと1950年と1990年の世界全域の人口から，人口増加率を計算してみよ。（答えは0.0184947になるはず。）

補足：[Mathematica](https://sandbox.open.wolframcloud.com)なら次のとおり。

```mathematica
sol = DSolveValue[p'[t] == r p[t], p[t], t]

NSolve[{2519470 == sol /. t -> 1950, 5279519 == sol /. t -> 1990}, {r, C[1]}, Reals]
```

**レポート課題**  Excelが計算を間違う例を見つけよ。ヒント：大きな数で試すとよいかもしれない。理由を考えたり調べたりしてもいいだろう（「コンピュータは2進数だから…」というのは間違い）。
